'use client';
import { useState, useEffect } from 'react';
import { useConnections } from 'wagmi';
import { Deferred } from '../utils/deferred';
// null means it's native token
let _pendingFeeConfirmation;
export function useWaasFeeOptions() {
    const connections = useConnections();
    const waasConnector = connections.find(c => c.connector.id.includes('waas'))?.connector;
    const [pendingFeeOptionConfirmation, setPendingFeeOptionConfirmation] = useState();
    function confirmPendingFeeOption(id, feeTokenAddress) {
        _pendingFeeConfirmation?.resolve({ id, feeTokenAddress, confirmed: true });
        setPendingFeeOptionConfirmation(undefined);
        _pendingFeeConfirmation = undefined;
    }
    function rejectPendingFeeOption(id) {
        _pendingFeeConfirmation?.resolve({ id, feeTokenAddress: undefined, confirmed: false });
        setPendingFeeOptionConfirmation(undefined);
        _pendingFeeConfirmation = undefined;
    }
    useEffect(() => {
        async function setup() {
            if (!waasConnector) {
                return;
            }
            const waasProvider = waasConnector.sequenceWaasProvider;
            if (!waasProvider) {
                return;
            }
            waasProvider.feeConfirmationHandler = {
                confirmFeeOption(id, options, txs, chainId) {
                    const pending = new Deferred();
                    setPendingFeeOptionConfirmation({ id, options, chainId });
                    _pendingFeeConfirmation = pending;
                    return pending.promise;
                }
            };
        }
        setup();
    });
    return [pendingFeeOptionConfirmation, confirmPendingFeeOption, rejectPendingFeeOption];
}
//# sourceMappingURL=useWaasFeeOptions.js.map